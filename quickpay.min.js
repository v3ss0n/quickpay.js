!function(a,b){"use strict";function c(a,b){return new CustomEvent(a,b||{})}function d(a,b,c){var d=document.createElement("button");return d.innerHTML=b||"Pay",d.className=c||"",d.addEventListener("click",function(a){return function(b){return a.open(),b.preventDefault(),!1}}(a)),d}function e(a){var b=document.createElement("input");return b.type="hidden",b.name=a,b}function f(a){for(var b,c={},d=/^data-qp-(.+)/i,e=0;e<a.length;e++)(b=a[e].name.match(d))&&(c[b[1].replace(/-([a-z])/g,function(a){return a[1].toUpperCase()})]=a[e].value);return c}if(!function(){function b(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}return"function"!=typeof a.CustomEvent&&(b.prototype=a.Event.prototype,void(a.CustomEvent=b))}(),a.Paysbuy=a.Paysbuy||{},!a.Paysbuy.QuickPay){var g=function(){function d(a){return new e(a)}function e(a){f(this,{_params:f({},g,a),_iframe:!1,_wrapper:!1,_checkoutWindow:!1,_container:a.container}),this._prepareCheckout()}function f(){var a=Array.prototype.slice.call(arguments),b=a[0];for(var c in a)if(c)for(var d in a[c])b[d]=a[c][d];return b}var g={key:"",tokenHandler:b,image:"",locale:"en-GB",submitLabel:"Pay {amount}",title:"",description:"",amount:0,currency:"THB"},h="http://localhost:3000",i="/dist/quickpay_domain",j="checkout.html",k="close",l=300,m={width:"100%",height:"100%",border:"none",margin:"0",opacity:"0",transform:"scale(0.9)",transition:l+"ms opacity ease, transform "+l+"ms"},n={backgroundColor:"rgba(0,0,0,0.75)",border:"none",opacity:"0",visibility:"hidden",zIndex:"99999",left:"0",top:"0",position:"fixed",overflowX:"hidden",width:"100%",height:"100%",transition:l+"ms opacity ease, transform "+l+"ms"};return f(e.prototype,{open:function(a){var b=f({},this._params,a||{});this._sendConfigToCheckout(b),this._resultHandler=b.onComplete,this._active=!0,this._showCheckout()},_prepareCheckout:function(){this._checkoutWindow||(this._wrapper=this._prepareWrapper(),this._iframe=this._prepareIframe(),this._checkoutListener=this._makeCheckoutListener())},_sendConfigToCheckout:function(a){try{this._checkoutWindow.postMessage(JSON.stringify(a),h+i)}catch(a){}},_listenToCheckout:function(){a.removeEventListener("message",this._checkoutListener),a.addEventListener("message",this._checkoutListener,!1)},_makeCheckoutListener:function(){return function(a){return function(b){return!!a._active&&(!(!b.origin||b.origin!=h)&&(b.data==k?a._hideCheckout():(a._resultHandler&&a._resultHandler(JSON.parse(b.data)),a._hideCheckout())))}}(this)},_showCheckout:function(){this._styleElement(this._wrapper,{visibility:"visible",opacity:1}),document.body.style.overflow="hidden",this._styleElement(this._iframe,{transform:"scale(1)",opacity:1}),this._listenToCheckout(),(this._container||document).dispatchEvent(c("qp_show",{bubbles:!0,cancelable:!1,detail:void 0}))},_hideCheckout:function(){setTimeout(function(a){return function(){a._wrapper.style.visibility="hidden"}}(this),1.2*l),document.body.style.overflow="",this._styleElement(this._iframe,{transform:"scale(0.9)",opacity:0}),this._wrapper.style.opacity="0",this._active=!1,(this._container||document).dispatchEvent(c("qp_hide",{bubbles:!0,cancelable:!1,detail:void 0}))},_prepareWrapper:function(){var a=this._createStyledElement("div",n);return document.body.appendChild(a),a},_prepareIframe:function(){var a=this._createStyledElement("iframe",m);return a.src=h+i+"/"+j,a.addEventListener("load",function(a){return function(b){a._checkoutWindow=b.target.contentWindow,a._sendConfigToCheckout(a._params)}}(this)),this._wrapper.appendChild(a),a},_createStyledElement:function(a,b){var c=document.createElement(a);return this._styleElement(c,b)},_styleElement:function(a,b){var c,d=["webkitT","MozT","msT","OT"],e=["-webkit-","-moz-","-ms-","-o-"];for(var f in b){if(a.style[f]=b[f],"transform"==f)for(c in d)a.style[d[c]+"ransform"]=b[f];if("transition"==f)for(c in e)a.style[e[c]+"transition"]=b[f].replace("transform",e[c]+"transform")}return a}}),{configure:d}}();a.Paysbuy.QuickPay=g}var h=function(){var a=document.getElementsByTagName("script");return a[a.length-1]}();if(h.getAttribute("data-qp-key")){var i,j=f(h.attributes),k=h.parentNode;j.container=k,i=a.Paysbuy.QuickPay.configure(j),k.appendChild(d(i,j.buttonLabel,h.className));var l=e(j.tokenFieldName||"qp-token");k.appendChild(l),i._params.onComplete=function(a,b,d){return function(b){a.value=b.token,a.dispatchEvent(c("qp_token_received",{bubbles:!0,cancelable:!0,detail:{token:b.token}})),d&&a.form.submit()}}(l,k,!j.noSubmit)}}(window);